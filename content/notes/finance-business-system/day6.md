---
title: "计算输入的正确性：怎么选择正确时间的数据"
date: 2023-04-28
tags:
  - 金融业务与系统
  - 系统正确性保障
categories:
  - 读书笔记
type: posts
lightgallery: true
description: "怎么选择正确时间的数据"
keywords: 
  - 金融系统
  - 分布式金融架构课
---



借缺正确性的第一个问题：怎么选择正确时间的数据

## 业务距离

国外养老基金，在退休后获取收益。
**衡量指标** 退休后，养老基金每年的收益率是否能超过每年生活费用的支付。

CPI 指标会在一个月，3个月，一年后分别公布和校对；需要在不同时间用不同指标。金融公司需要能重现这些数据的计算过程。采用**双时序数据库** 进行解决。


## 如何理解双时许数据库

- 两个时间：产出时间（VT,valid time) 和修改时间(TT, trasaction time)
- 单时序数据库解决的是数据增加问题，双时序数据库解决的是数据修改问题。

{{<figure src="day6-1.png" width="800" title="数据查询的可见范围">}}

- 数据查询关心的是 **离当前查询时间点最近的合理数据**
  - “合理”指的是数据既存在，且有意义
  - 查询的记录时间和发生时间不能比数据的时间要早
  - “最近”指的是当有多个数据都是合理的时候，选择发生时间最晚的数据

## 优缺点分析

### 优点

1. 数据的不变性
2. 数据的唯一性，数据基于发生时间和记录时间都有唯一的标识

> 过调整记录时间来选择性地引入数据变化在金融行业应用广泛，例如情景计算，基于特定场景下的风险评估

### 缺点

1. 学习成本高
2. 执行速度慢

### 注意事项

1. 理论上数据可见范围有限
2. 实际上不推荐约束发生时间的可见范围
